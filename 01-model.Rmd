```{r, echo=FALSE}
library(knitr)
proj_dir = getwd()
```

# A General Model of Learning Through Practices {#model}
## Introduction

Learning through practices, or learning by doing, is an important mode of learning. Practice, according to Merriam Webster, means "to do something again and again in order to become better at it". Although repetition is a necessary condition for mastery, it is not a sufficient one. What to practice, how to practice and when to practice affect the practice efficacy. This thesis focuses on the first aspect, the optimal choice of practice items.

The thesis defines practice as any learning task that produces an measured result or response. The measurement is a technical necessity for third party assessment. Because the mastery of skill or knowledge is not directly observed, the observed response anchors the inference of the latent mastery. For example, when batting with a baseball, by observing whether the batter hits the ball overtime, an observor is able to make inference on whether the practice is effective. However, if the batter just swings the bat without a ball, it is hard for the observor to tell if the batter is improving, even though the batter may indeed learn from the swinging. This narrow definition excludes some important learning activities. For instance, passively attending a lecture is not a practice because it produces no observed result. Similarly, reading textbook is not a practice either. Although the author acknowledges the importance, and the necessity, of non-practice learning activities, they are not the topic for this thesis.

**(no learning no measurement)**

**Define pedagogical efficacy**

Furthermore, this thesis tries to solve the following problem:

**Given the learner's previous practice sequences and a fixed item banks, which item shall the learner practice next?**

This question is at the heart of an intelligent learning recommendation system.


### The Dual Roles of Practice

Pratice plays dual roles in the learning process. On the one hand, it serves as an assessment of the learner's latent mastery; on the other hand, it serves as a pedagogical instrument for enhancing it. For learning analytics, the dual roles correspond to two key tasks: practice as assessment enables the diagnosis on the learner's current status; practice as instructions enables personalized learning based on the diagnostics. 

The assessment aspect of the practices is extensively studied in the literature. The family of models derived from the item response theory(IRT) [@rasch1960probabilistic;@Carlson2013IRT] has been used in many high-stake standardized tests, a testament to its success as an assessment tool. When applying the IRT model, one has to either assume no learning between practices by using joint responses or make inefficient inference on the latent mastery by using a single response. Because many standardized tests have no feedback or scaffolding guidance, the IRT model can reasonably assume that there is no learning in the process. However, in the context of practice by learning, neither approach is appealing. Therefore, pure assessment model, such as IRT, is not a suitable choice to model learning through practices.

Yet the instructional aspect of the practices is less well understood. It is generally agreed that scaffolding guidance is necessary for any pedagogy to be effective. However, there are many disagreements on the amount, the timing and the context of guidance. This thesis does not attempt to explicitly explain what make practices effective but focuses on empirically evaluating the pedagogical efficacy of the practices. If the efficacy can be estimated with precision, domain experts can use it to develop better practices through experiments and engineers can use it to tune the personalized recommendations from the content pool.

In the learning analytics literature, the measurement of pedagogical efficacy, or learning rate, starts with Corbett and Anderson's seminal model[-@corbett1994knowledge] on the acquisition of procedural knowledge, or the Bayesian Knowledge Tracing model(BKT). Compared to pure assessment model that assumes responses to questions are indepedent conditioning on the same latent mastery, the BKT model assumes that responses are independent conditioning on varing latent mastery. The evolvement of the latent mastery characterizes the learning process. Although the BKT model makes some strong simplifying assumptions, it captures the key process of learning through practices. Therefore, this thesis builds the general model on the basis of the BKT model.

### Evolution of the Bayesian Knowledge Tracing Model

** Do a literature review **

However, the BKT model does not capture the following features of the empirical data which compromise its estimation of the pedagogical efficacy:

(1) The learners quit in the middle of the practice sequence at a differential rate depending on the previous performance
(2) The learners may not exert effort in practices and the lack of effort persists for some learners if the underlying knowledge and skill are the same for subsequent questions.
(3) The learners exhibit reinforcement learning where positive performance leads to better performance.

The thesis aims to build a model that is rich enough to capture the features above but parsimonious enough to be generally applicable.



## Notations
The practice item id is noted as $j\in\{1,\dots,J\}$.

The practice sequence id is noted as $t \in \{1,\dots, T\}$. In this model, the learning is not timed by the calendar but the number of practices done. In the following analysis, "time" and "sequence" are used interchangeably.
 
The assignment of an item to the practice sequence is defined as $A_t$. The latent mastery at each practice opportunity is noted as $X_t$. The observed response at each practice opportunity is noted as $Y_t$. The effort decision at each practice opportunity is noted as $E_t$. The stop decision at each practice opportunity is noted as $H_t$.

For a particular practice sequence with length $T$, denote the joint responses as

$$\mathbf{Y}_{1,T} = (Y_1,\dots,Y_T) $$
Similarly,  $\mathbf{X}_{1,T}$ is the joint latent masteries, $\mathbf{E}_{1,T}$  the joint effort decisions, $\mathbf{H}_{1,T}$  the joint stop decisions, and $\mathbf{A}_{1,T}$  the joint item compositions.

Let $\mathbf{y}_{1,T}=(y_1,\dots, y_T)$ be the realized response sequence where
$$
P(\mathbf{Y}_{1,T}=\mathbf{y}_{1,T}) = P(Y_1=y_1,\dots, Y_T=y_T)
$$
Similary, $\mathbf{x}_{1,T}$ is the realized joint latent masteries, $\mathbf{e}_{1,T}$  the realized joint effort decisions, $\mathbf{h}_{1,T}$  the realized joint stop decisions, and $\mathbf{a}_{1,T}$  the realized joint item compositions.

For simplicity, when refering to the whole practice sequence, the underlabel $1,T$ is dropped throughout the thesis.

## Learning Through Practices with Observed Response Only

The first step toward the general model of learning through practices is the extension of the Bayesian Knowledge Tracing model to a general Hidden Markove process where there is more than one question item and more than two states in latent mastery and observed responses.

### Event Sequence

1. The learner is presented with a practice question.

2. The learner produces a response according to the latent mastery.

3. The learner receives a feedback. 

3. The learner learns (elevates latent mastery) probabilistically.

4. Repeat from 1.

The timing of learning is of interest here. There are two possible learning junctures, after solving the problem yet to see the feedback and after receiving the feedback. The thesis argues that they are inseparable because they are so complementary that leaving one out has detrimental effect on learning: If the learners do not struggle themselves, giving them a detailed feedback is like coaching how to swim on shore; If the learners do not receive the feedback, letting them struggle is like asking them to run straight with eyes blinded. 

The timing of learning is not specified in the Bayesian knowledge tracing model because the two learning process cannot be separately identified with only one item even if we wish to. However, with multiple items, it is possible to model the two learning junctures separately. Although the author acknowledges the possibility and the value (in some scenario) to do so, the thesis refrains from doing so because of the complementarity argument.



### Assumption for the General Hidden Markov Process

This section discuess the assumptions needed to represent the learning processing as a single dimensional first order Markov process.


**Assumption 1**:  $X_t$ is a unidimenstional discrete variables with $M_x$ number of states.

The unidimensionality assumption avoids the complexity of characterizing the response as a function of multiple inputs. It there is only one solution that requires several steps of reasoning, the probabilities of mastering each latent knowledge component are multiplicative. If there is more than one solutions, then between solutions the probabilities is additive while within solutions the probabilities are multiplicative. In addition, if the latent states are multi-dimensional, the state transition matrix of one dimension is unlikely to be independent of all other dimensions. The number of the transition matrix explodes exponentially, which may result in infeasible parameter estimation. 

Readers familiar with the literature of Item Response Theory (IRT) may wonder why the latent mastery is not continuous. The price for continuity is the functional specification of the response curve. As for the functional specification of the response curve, the continuous state space is probably better when the distinguishing parameter is small while the discrete state space is better when the distinguishing parameter is large and there is a mixture. If the continuous space has a linear transition kernel (constant learning), the discrete space also enjoys the flexibility of non-constant learning. 

**Better explanation**

Define the general pedagogical efficacy as the probability of practice item $j$ moving the learner's knowledge mastery status from $m$ to $n$, after exposing to a sequence of items and feedbacks.

$$
\ell^{m,n}_{\mathbf{Y}_{1,t};\mathbf{A}_{1,t-1},j;t} = P(X_t=m|X_{t-1}=n,\mathbf{Y}_{1,t}, \mathbf{A}_{1,t-1},A_t=j,t)
$$

**Assumption 2**: Learning does not dependent on the result of the response.

Previous failures do not disencourage the learner and previous successes do not stimulate learning either. The pedagogical efficacy reduces to 
$$
\ell^{m,n}_{\mathbf{A}_{1,t-1},j;t} = P(X_t=m|X_{t-1}=n, \mathbf{A}_{1,t-1},A_t=j,t)
$$

**Assumption 3**: There is no complementarity or substitution effect in the sequence item composition.

Assumption 3 mainly rules out scaffolding item sequences where a string of easy items builds up to the final difficult item. It also rules out naive repeititon has decreasing pedagogical efficacy.  If the string of items are nearly identical and the learner does not learn from the first attempt, it is reasonable to assume that the learner is unlikely to learn in the subsequence opportunites, but A2 says the learner has constant probability of learning. The pedagogical efficacy can be reduced to 


$$
\ell^{m,n}_{j;t} = P(X_t=m|X_{t-1}=n,A_t=j, t)
$$


**Assumption 4**: The pedagogical efficacy is independent of the sequence position.

A3 assumes that the learner has the same probability of learning if the item is the first encouter and if the item is the 10th encounter in the sequence. It further reduces the pedagogical efficacy to

$$
\ell^{m,n}_{j} = P(X_t=m|X_{t-1}=n,j)
$$

A2 to A4 essentially assumes that the learner is the paragon of grit and positive psychology. They are never frustrated by failures , never bored by repetition and can concentrate as long as it takes. Standing alone, these are very strong assumptions. The latter half of this chapter is going to make them more plausible by conditional on the same behavior pattern. 



### Non-regressive Learning

The learning process of interest to the author is narrower than the general learning process described in the previous section. The learner finished all the practices in a short time window, less than 10 minutes usually, and short term mastery retention is used to characterize the user. Under such circumstances, one can argue that there is no forgetting between practice opportunties and no practices that make learners forget what they have already mastered. In another words 


**Assumption 5**: The latent state never regresses as the practices proceed

To wit:

$$
p(X_t=m|X_{t-1}=n, j)=0 \quad \forall t,j \quad\text{where} \quad m < n
$$


### The Observed Response

Conditioning on the latent mastery $X_t$ and the item assignment $A_t$, the response is generated by a multinomial distribution with probability mass function

$$
P(Y_{t}=r|X_t=k,A_t=j) = c^{r,k}_j
$$

### Example: Bayesian Knowledge Tracing Model

The classical Baysian Knowledge Tracing (BKT) model is a special case of where $M_x=M_y=2$ and $N_j=1$. Therefore, the system is described by the following four parameters: initial mastery($\pi$), the learning rate($\ell$), the guess rate($g$), and the slip rate($s$)

$$
\begin{aligned}
\pi &= P(X_1=1)\\
\ell &= P(X_t=1|X_{t-1}=0)\\
g &= P(Y_t=1|X_t=0)\\
s &= P(Y_t=0|X_t=1)
\end{aligned}
$$

In the notation of this chapter, $s=1-c^{1,1}$ and $g=c^{1,0}$.

### Representation as a Graph Model

```{r, echo=FALSE, message=FALSE, warning=FALSE}
include_graphics('fig/hmm_1.png')
```


## The General Model of Learning Through Practices

The key assumptions from the responses only model assumes high engagement for all learners. This section discuss how to extend the general model to include behavior patterns.

### Event Sequence

1. The learner is presented with a practice question.

2. The learner decides the effort level depends on their latent mastery state

3. The learner produces a response according to the effort level and the latent mastery. 

4. The learner receives the feedback.

5. If the learner exerts effort, he learns probabilistically. Otherwise, there is no learning.

6. The learner can choose or be forced to stop. If the learner continues, repeat from (1); else data collection stops.



### The Effort Decision

**Assumption 6:** The effort is a Binary Choice with value 0 and 1 where $E_t=0$ is slacking and $E_t=1$ is exerting effort.

**Assumption 7:** Conditioning on the latent mastery and the item, the effort choice is independent.


$$
P(E_t=1|X_t=k, A_t=j) = \gamma_j^k
$$


The effort level is important because it shapes the learning gain and the observed response. Motivated by the intuition of "no pain no gain", if the learner does not exert effort, the pedagogical efficacy is always zero. 

**Assumption 8**: $P(X_t=m|X_{t-1}=n, A(t)=j, E_t=0) = 0 \forall j, m > n$

Furthermore, assume that if the learner does not exert effort, the response is always completely incorrect. 

**Assumption 9**: $P(Y_t=0|E_t=0,A_t=j) = 1 \forall j$

It shall be noticed that assumption 7 and assumption 8 generate positive autocorrelation in the effort choice unconditionally, if the probability of slacking is negatively correlated with the latent mastery. Because learner with lower mastery slacks more, they are less likely to learn and thus continue to exhibit high slacking rate. However, there is good reasons to believe that the effort choice is positive correlated even conditioning on the latent mastery when the item is similar enough because the learner learns about the cost of making an attempt in the first encounter. This phenomenon is not captured by the current model.  



### The Stop Decision

The hazard rate at sequence $t$ is the probability of exit conditioning on continue at sequence $t-1$. Assume

**Assumption 10**: Stop decision is independent of item characteristics


$$
h_t=P(H_t=1|H_{t-1}=0,X_t,Y_t)
$$
Whether the differential hazard rate depends on the response or the state merits some discussions. If the difference in the hazard rates depend on the response, a model without the stopping decision consitently estimated $\pi$,$\ell$, and $c$. However, if the difference in the hazard rates depend on the state, a model without the stopping decision introduces selection bias into other parameters. Both dependence structures can happen in reasonable scenarios. "X-Strike" rule is an example of the response dependent hazard model. If the learner always keep going unless is forced to stop after accumulating X failures, the stop decision is a function of the responses, and the hazard rate depends on the responses. In contrast, the differential attrition caused by boredom or frustration is likely a case of state dependent hazard model. If the learner has already mastered the knowledge point, further practices produce no learning gain and they are bored. If the learner hasn't mastered the knowledge point after a few exercises, they are frustrated. This may cause the differential hazard rate.


Furthermore, the functional form of hazard rate may also be scenario dependent. Continue with the previous two examples. If the hazard rate is driven by boredom or frustration, it is reasonable to model the duration dependence as a proportional hazard model with time trend. Thus the hazard rate can be expressed as:

$$
P(H_t=1|H_{t-1}=0,X_t=k)= h_t^k = \lambda_k e^{\beta_k t} 
$$

However, if the hazard rate is driven by the X-strike rule, then the hazard rate is likely to be discontinuous. Without further knowledge on the functional form, it is reasonable to specify a discrete cell estimator on the hazard rate
$$
 P(H_t=1|H_{t-1}=0,Y_t=r)= h_t^r
$$

Chapter 3 will discuss the ramification of the dependence structure and functional form on the estimation of the pedagogical efficacy.


### Example: Zone of Proximal Development

Because the constraints of binary states imposed by the BKT model are relaxed, the general model can have arbitrary representation of the learning process, to the extent that the data allows for unique identification. To avoid abusing the general model as pure data mining exercises, some guidance from a learning theory is required to specify the model parameter structure. Here presents the modeling of Vygotsky's theory of the zone of proximal development[@vygotsky1978interaction] as an example.


The zone of proximal development postulates three types of relationship between the mental development of the learner and the mental requirement of the learning task. If the learner's mental development lags the mental requirement of the learning task, the learning is slow, the engagement is low, and the performance is poor. If the learner falls shorts of the requirement of the learning task if done independently but within his reach under the guidance or in collaboration, a.k.a. the zone of proximal development, the learning speeds up, the engagement is high, and the performance improves. If the learner's mental development exceeds the requirement of the practices, the performance is high albeit there is no learning.

This theory naturally calls for a three state latent mastery($M_x=3$) and imposes some structure on the observed response and observed effort rate.

$$
\begin{aligned}
P(Y_t=0|X_t=0) &\approx 1\\
P(E_t=0|X_t=0) &\approx 1\\
P(Y_t=0|X_t=2) &\approx 0\\
P(Y_t=0|X_t=2) &\approx 0\\
\end{aligned}
$$

In addition, the learning reinforcement, which states that it is easier to reach mastery if the learner has met the learning requirement than if the learner has not, can be intepreted as:

$$
P(X_t=2|X_t=1) \gg P(X_t=2|X_t=0) \approx 0
$$

These are empirically testable implications if one believes the data generating process of learning is consistent with Vygosky's zone of proximal development. 


